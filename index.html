<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Chess Game</title>
    <style>
        table {
            border-collapse: collapse;
            outline: 1px solid black;
        }
        td {
            width: 100px;
            height: 100px;
            text-align: center;
            font-size: 60px;
            cursor: pointer;
        }
        th {
            background: lightgray;
        }
        tr:nth-child(even) td:nth-child(odd),
        tr:nth-child(odd) td:nth-child(even) {
            background: gray;
        }
        tr:first-child th, tr:last-child th {
            height: 50px;
        }
        th:first-child, th:last-child {
            width: 50px;
        }
        .controls {
            margin: 20px;
        }
        .status {
            margin: 10px;
            font-size: 20px;
        }
    </style>
    <!-- Include the chess.js library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.10.3/chess.min.js"></script>
</head>
<body>
    <div class="controls">
        <button id="resign">Resign</button>
        <button id="draw">Draw</button>
        <div class="status" id="status"></div>
    </div>
    <table>
        <tr>
            <th></th>
            <th>A</th>
            <th>B</th>
            <th>C</th>
            <th>D</th>
            <th>E</th>
            <th>F</th>
            <th>G</th>
            <th>H</th>
            <th></th>
        </tr>
        <tr>
            <th>8</th>
            <td class="cell" data-pos="a8">&#9820;</td>
            <td class="cell" data-pos="b8">&#9822;</td>
            <td class="cell" data-pos="c8">&#9821;</td>
            <td class="cell" data-pos="d8">&#9819;</td>
            <td class="cell" data-pos="e8">&#9818;</td>
            <td class="cell" data-pos="f8">&#9821;</td>
            <td class="cell" data-pos="g8">&#9822;</td>
            <td class="cell" data-pos="h8">&#9820;</td>
            <th>8</th>
        </tr>
        <tr>
            <th>7</th>
            <td class="cell" data-pos="a7">&#9823;</td>
            <td class="cell" data-pos="b7">&#9823;</td>
            <td class="cell" data-pos="c7">&#9823;</td>
            <td class="cell" data-pos="d7">&#9823;</td>
            <td class="cell" data-pos="e7">&#9823;</td>
            <td class="cell" data-pos="f7">&#9823;</td>
            <td class="cell" data-pos="g7">&#9823;</td>
            <td class="cell" data-pos="h7">&#9823;</td>
            <th>7</th>
        </tr>
        <tr>
            <th>6</th>
            <td class="cell" data-pos="a6"></td>
            <td class="cell" data-pos="b6"></td>
            <td class="cell" data-pos="c6"></td>
            <td class="cell" data-pos="d6"></td>
            <td class="cell" data-pos="e6"></td>
            <td class="cell" data-pos="f6"></td>
            <td class="cell" data-pos="g6"></td>
            <td class="cell" data-pos="h6"></td>
            <th>6</th>
        </tr>
        <tr>
            <th>5</th>
            <td class="cell" data-pos="a5"></td>
            <td class="cell" data-pos="b5"></td>
            <td class="cell" data-pos="c5"></td>
            <td class="cell" data-pos="d5"></td>
            <td class="cell" data-pos="e5"></td>
            <td class="cell" data-pos="f5"></td>
            <td class="cell" data-pos="g5"></td>
            <td class="cell" data-pos="h5"></td>
            <th>5</th>
        </tr>
        <tr>
            <th>4</th>
            <td class="cell" data-pos="a4"></td>
            <td class="cell" data-pos="b4"></td>
            <td class="cell" data-pos="c4"></td>
            <td class="cell" data-pos="d4"></td>
            <td class="cell" data-pos="e4"></td>
            <td class="cell" data-pos="f4"></td>
            <td class="cell" data-pos="g4"></td>
            <td class="cell" data-pos="h4"></td>
            <th>4</th>
        </tr>
        <tr>
            <th>3</th>
            <td class="cell" data-pos="a3"></td>
            <td class="cell" data-pos="b3"></td>
            <td class="cell" data-pos="c3"></td>
            <td class="cell" data-pos="d3"></td>
            <td class="cell" data-pos="e3"></td>
            <td class="cell" data-pos="f3"></td>
            <td class="cell" data-pos="g3"></td>
            <td class="cell" data-pos="h3"></td>
            <th>3</th>
        </tr>
        <tr>
            <th>2</th>
            <td class="cell" data-pos="a2">&#9817;</td>
            <td class="cell" data-pos="b2">&#9817;</td>
            <td class="cell" data-pos="c2">&#9817;</td>
            <td class="cell" data-pos="d2">&#9817;</td>
            <td class="cell" data-pos="e2">&#9817;</td>
            <td class="cell" data-pos="f2">&#9817;</td>
            <td class="cell" data-pos="g2">&#9817;</td>
            <td class="cell" data-pos="h2">&#9817;</td>
            <th>2</th>
        </tr>
        <tr>
            <th>1</th>
            <td class="cell" data-pos="a1">&#9814;</td>
            <td class="cell" data-pos="b1">&#9816;</td>
            <td class="cell" data-pos="c1">&#9815;</td>
            <td class="cell" data-pos="d1">&#9813;</td>
            <td class="cell" data-pos="e1">&#9812;</td>
            <td class="cell" data-pos="f1">&#9815;</td>
            <td class="cell" data-pos="g1">&#9816;</td>
            <td class="cell" data-pos="h1">&#9814;</td>
            <th>1</th>
        </tr>
        <tr>
            <th></th>
            <th>A</th>
            <th>B</th>
            <th>C</th>
            <th>D</th>
            <th>E</th>
            <th>F</th>
            <th>G</th>
            <th>H</th>
            <th></th>
        </tr>
    </table>

    <script>
        const chess = new Chess();
        let selectedCell = null;
        const statusElement = document.getElementById('status');

        document.querySelectorAll('.cell').forEach(cell => {
            cell.addEventListener('click', () => {
                if (selectedCell) {
                    movePiece(selectedCell, cell);
                    selectedCell = null;
                } else if (cell.innerHTML) {
                    selectedCell = cell;
                    cell.style.backgroundColor = 'yellow';
                }
            });
        });

        document.getElementById('resign').addEventListener('click', () => {
            const winner = chess.turn() === 'w' ? 'Black' : 'White';
            alert(`${winner} wins by resignation.`);
            resetGame();
        });

        document.getElementById('draw').addEventListener('click', () => {
            alert('The game is a draw.');
            resetGame();
        });

        function movePiece(fromCell, toCell) {
            const fromPos = fromCell.getAttribute('data-pos');
            const toPos = toCell.getAttribute('data-pos');
            const move = chess.move({ from: fromPos, to: toPos });

            if (move) {
                toCell.innerHTML = fromCell.innerHTML;
                fromCell.innerHTML = '';
                fromCell.style.backgroundColor = '';
                resetBoardColors();
                updateStatus();

                // Handle pawn promotion
                if (move.flags.includes('p')) {
                    const piece = move.color === 'w' ? '&#9813;' : '&#9819;';
                    toCell.innerHTML = piece;
                }
            } else {
                fromCell.style.backgroundColor = '';
                alert('Invalid move! Try again.');
            }
        }

        function resetBoardColors() {
            document.querySelectorAll('.cell').forEach(cell => {
                cell.style.backgroundColor = '';
            });
        }

        function updateStatus() {
            let status = '';

            if (chess.in_checkmate()) {
                status = `Game over, ${chess.turn() === 'w' ? 'Black' : 'White'} is in checkmate.`;
            } else if (chess.in_draw()) {
                status = 'Game over, drawn position.';
            } else {
                status = `${chess.turn() === 'w' ? 'White' : 'Black'} to move`;
                if (chess.in_check()) {
                    status += ', ' + (chess.turn() === 'w' ? 'White' : 'Black') + ' is in check';
                }
            }

            statusElement.textContent = status;
        }

        function resetGame() {
            chess.reset();
            resetBoard();
            updateStatus();
        }

        function resetBoard() {
            document.querySelectorAll('.cell').forEach(cell => {
                cell.innerHTML = '';
                cell.style.backgroundColor = '';
            });

            // Set up initial board position
            const startingPosition = chess.fen().split(' ')[0];
            const pieces = {
                'p': '&#9817;',
                'r': '&#9814;',
                'n': '&#9816;',
                'b': '&#9815;',
                'q': '&#9813;',
                'k': '&#9812;'
            };

            startingPosition.split('/').forEach((row, rowIndex) => {
                let colIndex = 0;
                row.split('').forEach(char => {
                    if (!isNaN(char)) {
                        colIndex += parseInt(char);
                    } else {
                        const color = char === char.toUpperCase() ? 'w' : 'b';
                        const piece = pieces[char.toLowerCase()];
                        const cell = document.querySelector(`.cell[data-pos="${String.fromCharCode(97 + colIndex)}${8 - rowIndex}"]`);
                        if (cell) cell.innerHTML = piece;
                        colIndex++;
                    }
                });
            });
        }

        resetBoard();
        updateStatus();
    </script>
</body>
</html>
